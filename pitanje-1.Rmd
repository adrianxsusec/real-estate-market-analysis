---
output:
  pdf_document: default
  html_document: default
---
# Necesarry libraries

```{r}
library(readr)
library(dplyr)
library(ggplot2)
```

# Loading dataset

```{r}
dataset <- read_csv("preprocessed_data.csv")
```


```{r}
# Pitanje 1. "Određuje li oblik zemljišne čestice broj katova kuće?"
```
Postavljamo hipoteze:

Ho: broj katova kuće ne ovisi o obliku zemljišne čestice
H1: broj katova kuće ovisi o obliku zemljišne čestice

Učitavamo dataset u varijablu df sa kojom ćemo dalje raditi.
```{r}
df <- dataset

```


Grupiramo vrijednosti podataka u stupcu. Stambene objekte koji imaju 1.5 kat tretiramo kao da imaju 1 kat, a objekte koji imaju 2.5 kata tretiramo kao da imaju 2 kata. 
```{r}

df$HouseStyle <- gsub("1.5Fin", "1Story", df$HouseStyle)
df$HouseStyle <- gsub("1.5Unf", "1Story", df$HouseStyle)
df$HouseStyle <- gsub("2.5Fin", "2Story", df$HouseStyle)
df$HouseStyle <- gsub("2.5Unf", "2Story", df$HouseStyle)
df$HouseStyle <- gsub("SFoyer", "2Story", df$HouseStyle)
df$HouseStyle <- gsub("SLvl", "2Story", df$HouseStyle)
df$LotShape <- gsub("IR3", "IR2", df$LotShape)

df

```



```{r}

ggplot(df, aes(x = LotShape, fill = HouseStyle)) +
  geom_bar(position = "dodge")
```

Napravit ćemo kontingencijsku tablicu i dodati joj marginalne vrijednosti.
```{r}
table <- table(df$LotShape, df$HouseStyle)

margins_tbl = addmargins(table)
print(margins_tbl)
```

`chisq.test()` se može izvršiti samo ako očekivana frekvencija pojedinog razreda iznosi najmanje 5. Pretpostavka testa je da je ovo uvjet zadovoljen, stoga se prije provođenja testa mora provjeriti da li je očekivana frekvencija pojedinog razreda veća ili jednaka 5.
```{r}

for (col_names in colnames(margins_tbl)){
  for (row_names in rownames(margins_tbl)){
    if (!(row_names == 'Sum' | col_names == 'Sum') ){
      cat('Očekivane frekvencije za ',col_names,'-',row_names,': ',(margins_tbl[row_names,'Sum'] * margins_tbl['Sum',col_names]) / margins_tbl['Sum','Sum'],'\n')
    }
  }
}

```


Sve očekivane frekvencije su veće od 5. Možemo nastaviti sa`chisq.test()` testom.
Prethodno spomenute hipoteze testiramo testom nezavisnoti pomoću chi testa.
```{r}

test = chisq.test(df$LotShape, df$HouseStyle, simulate.p.value = TRUE, B = 1000)

```
p < 0.05
Na temelju p vrijednosti odbacujemo hipotezu "H0:broj katova kuće ne ovisi o obliku zemljišne čestice". Prihvaćamo alternativnu hipotezu "H1: broj katova kuće ovisi o obliku zemljišne čestice" i zaključujemo da broj katova kuće ovisi o obliku zemljišne čestice.