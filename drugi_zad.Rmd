# Drugi zadatak

```{r}
library(readr)
```

```{r}
dataset <- read_csv("preprocessed_data.csv")
```

```{r}

basement_area = dataset$TotalBsmtSF
neighbourhood = dataset$Neighborhood

quartiles = quantile(basement_area, probs=c(.25, .75), na.rm=FALSE)
IQR = IQR(basement_area)
lower <- quartiles[1] - 1.5*IQR
upper <- quartiles[2] + 1.5*IQR 

basement_no_outliers = subset(basement_area, basement_area > lower & basement_area < upper)

hist(basement_no_outliers, breaks = 20)


```
Dani su podaci veličine podruma i kvart u kojoj se nekretnina nalazi.

```{r}
length(unique(neighbourhood))
unique_neighbourhood <- sort(unique(neighbourhood))
unique_neighbourhood
```
Postoji 25 različitih kvartova za koje ispitujemo utječu li na veličinu podruma

# ANOVA

Koristit ćemo statistički test ANOVA kako bi testirali sredinu više populacija. U našem slučaju imamo 25 kvartova gdje ćemo za svaki kvart izračunati srednju veličine garaže. 

#U analizi varijance pretpostavlja se da je ukupna varijabilnost u podatcima posljedica varijabilnosti podataka unutar svakog pojedine
#grupe (populacije) i varijabilnosti između različitih grupa. Varijabilnost unutar pojedinog uzorka je rezultat slučajnosti, a ako
#postoje razlike u sredinama populacija, one će biti odražene u varijabilnosti među grupama. Jedan od glavnih ciljeva analize
#varijance je ustanoviti jesu li upravo te razlike između grupa samo posljedica slučajnosti ili je statistički značajna.

Pretpostavke ANOVA-e su:

- nezavisnost pojedinih podataka u uzorcima,
- normalna razdioba podataka,
- homogenost varijanci među populacijama. 

Provjera normalnosti može se za svaku pojedinu grupu napraviti KS testom ili Lillieforsovom inačicom KS testa. U ovom slučaju razmatrat ćemo kvart kao nezavisnu varijablu i veličinu garaže kao zavisnu varijablu.


#basement_area = dataset$TotalBsmtSF
#neighbourhood = dataset$Neighborhood

```{r}
require(nortest)
lillie.test(basement_no_outliers)
```


```{r test pretpostavki - normalnost}
require(nortest)
lillie.test(basement_area)
unique_neighbourhood <- unique_neighbourhood[!unique_neighbourhood == "Blueste"]
lillieT <- c()

for (n in unique_neighbourhood) {
  append(lillie.test(dataset$TotalBsmtSF[dataset$Neighborhood==n]), lillieT)
}

```

```{r test pretpostavki - homogenost varijanci}

# Testiranje homogenosti varijance uzoraka Bartlettovim testom
bartlett.test(basement_area ~ neighbourhood)

basement_area_var <- c()
for (n in unique_neighbourhood) {
  basement_area_var <- c(basement_area_var, var((basement_area[neighbourhood==n])))
}
basement_area_var
var_df <- data.frame(unique_neighbourhood, basement_area_var)
var_df

sqrt(var_df$basement_area_var)
bartlett.test(basement_area_var ~ neighbourhood)
```

Provjerimo postoje li razlike u veličini podruma za različite razine kvartove.

```{r test razlike u veličini podruma}

# Graficki prikaz podataka
boxplot(dataset$TotalBsmtSF ~ dataset$Neighborhood)

# Test
a = aov(dataset$TotalBsmtSF ~ dataset$Neighborhood)
summary(a)

```


